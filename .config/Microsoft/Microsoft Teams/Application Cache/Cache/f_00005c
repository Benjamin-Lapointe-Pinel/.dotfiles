webpackJsonp([12],{2240:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),t(2241)},2241:function(e,n,t){"use strict";var o=this&&this.__extends||function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])})(n,t)};return function(n,t){function o(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var r=t(2242),i=t(2243),s=function(e){function n(n,t,o){var r=e.call(this,o)||this;return r.transportDependencyProviderService=n,r.logger=n.loggingService.newLogger("transportLazyLoadService"),r.initializeOnAppLaunchAndReinit(),r}return o(n,e),n.$inject=["transportDependencyProviderService","transportAgentService","orchestrationService"],n.prototype.getTransportCommandRouter=function(){return this.transportCommandRouter},n.prototype.getTransportConnectionHandler=function(){return this.transportConnectionHandler},n.prototype.initializeTranportConnectionHandling=function(e,n){this.transportCommandRouter=new i.TransportCommandRouter(this.transportDependencyProviderService,n,e),this.transportConnectionHandler=new r.TransportConnectionHandler(this.transportDependencyProviderService,this.transportCommandRouter)},n.prototype.cleanupOnAppTeardown=function(e){this.logger.info("clean up has been called. marking commandRouter and connectionHandler as undefined."),this.transportConnectionHandler.cleanUpConnectionHandler(),this.transportCommandRouter=void 0,this.transportConnectionHandler=void 0},n.prototype.initializeOnAppLaunchAndReinit=function(e){},n.prototype.mtmaTelemetryIdentifier=function(){return"TransportLazyLoadService"},n}(teamspace.services.MTMABase);n.TransportLazyLoadService=s,angular.module("teamspace.transportLazyLoadService",["teamspace.transportDependencyProviderService","teamspace.transportAgentService"]).service("transportLazyLoadService",s)},2242:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o;!function(e){e.InitState="InitState",e.IsScanRunning="IsScanRunning",e.LastKeepAliveSentForSession="LastKeepAliveSentForSession",e.IsSendingKeepAlives="IsSendingKeepAlives",e.HasConnectedDevices="HasConnectedDevices",e.HasPairedDevices="HasPairedDevices",e.PairedDeviceCount="PairedDeviceCount",e.IsContinousScanRunning="IsContinousScanRunning"}(o||(o={}));var r=function(){function e(e,n){this.transportDependencyProviderService=e,this.transportCommandRouter=n,this.keepAliveInterval=3e4,this.deviceNotFoundThreshold=15e3,this.ComponentName="TransportConnectionHandler",this.keepAliveTimer=void 0,this.logger=e.loggingService.newLogger(this.ComponentName),this.constants=e.constants,this.storageService=e.storageService,this.bluetoothLEService=e.bluetoothLEService,this.logger.info("connectionHandler object successfully created, initialization is still pending.")}return e.prototype.initializeConnectionHandler=function(){this.logger.info("initializing states and Ipc listeners, and rehydrating previous connection."),this.setupInitialStates(),this.setupIpcForMachineState(),this.rehydratePreviousConnection(),this.states.set(o.InitState,teamspace.services.ITransportComponentState.Initialized),this.logger.info("connectionHandler successfully initialized")},e.prototype.onNewDevicePaired=function(n){this.logger.info("Caching new device paired");var t,o=this.getAllPairedDevices();o&&(t=o.filter(function(e){return e.endPointId!==n.endPointId})),o=t?t.concat(n):[n],this.storageService.set(e.BTPairedDevicesKey,o),this.storageService.set(e.LastPairedDeviceEndpointKey,n.endPointId),this.setupKeepAlive()},e.prototype.onDeviceUnpaired=function(n){var t=this.getAllPairedDevices();if(t){if(!t.find(function(e){return e.endPointId===n.endPointId}))return void this.logger.error("Current device not found in list of paired devices");this.disconnect(!0,!1);var o=t.filter(function(e){return e.endPointId!==n.endPointId});this.storageService.set(e.BTPairedDevicesKey,o),this.storageService.set(e.LastPairedDeviceEndpointKey,""),this.storageService.set(e.LastSaltUpdateTimeKey,"0"),this.logger.info("Device unpaired")}else this.logger.error("No paired devices found")},e.prototype.onDeviceLocked=function(n){var t=this.getAllPairedDevices();if(t){var o=t.find(function(e){return e.endPointId===n.endPointId});o?(o.connectionStatus=teamspace.services.PairedConnectionStatus.Locked,this.storageService.set(e.LastPairedDeviceEndpointKey,n.endPointId),this.logger.info("Paired device status set to: locked")):this.logger.error("Device not found in list of pairedDevices")}else this.logger.error("No paired devices found")},e.prototype.onDeviceUnlocked=function(n){var t=this.getAllPairedDevices();if(t){var o=t.find(function(e){return e.endPointId===n.endPointId});o?(o.connectionStatus=teamspace.services.PairedConnectionStatus.Connected,this.storageService.set(e.LastPairedDeviceEndpointKey,n.endPointId),this.logger.info("Paired device status set to: unlocked and connected")):this.logger.error("Device not found in list of pairedDevices")}else this.logger.error("No paired devices found")},e.prototype.getConnectedDevice=function(){var e=this.getAllPairedDevices();if(e)return e.find(function(e){return e.connectionStatus===teamspace.services.PairedConnectionStatus.Connected})},e.prototype.continousCheckProximity=function(e){var n=this;if(void 0===e&&(e=!1),this.continousCheckProximityInterval)this.logger.error("A continous check for proximity is already running, isReconnectCallback is - "+e);else{var t=3e3+this.deviceNotFoundThreshold;this.continousCheckProximityInterval=setInterval(function(){e?n.checkProximity().then(n.reconnectCallback):n.checkProximity().catch(function(){n.logger.info("checkProximity failed, dont have a reconnectCallback function")})},t)}},e.prototype.checkProximity=function(){var e=this;this.logger.info("Attempting Proximity check");var n=this.transportDependencyProviderService.$q,t=n.defer(),r=this.bluetoothLEService;return this.transportDependencyProviderService.canInitializeTransport()?(teamspace.services.QCancelable.toCancelablePromise(n,r.onceInitialized()).then(function(){if(!r.isBLEsupported||!r.isBluetoothRadioOn){var n="Bluetooth scan was not started. BLE might not be supported";return e.logger.error(n),t.reject(n),t.promise}e.logger.info("Scan started for better together companion devices."),e.states.set(o.IsScanRunning,!0);var i,s=setTimeout(function(){r.unsubscribe(i),e.logger.log("Unsubscribed for blehandle "+i+" due to timeout."),t.resolve(!1),e.logger.error("Timeout reached. Device not found. Scan stopped"),e.states.set(o.IsScanRunning,!1)},e.deviceNotFoundThreshold);i=r.subscribe(function(n,o){e.onCompanionDevicesFound(o,t,i,s)},e.constants.events.bluetoothLE.adjacent,e.constants.events.bluetoothLE.companionDiscovery)}).catch(function(n){n="Bluetooth scan was not started. BLE might not be supported due to error - "+n.toString(),e.logger.error(n),t.reject(n),e.states.set(o.IsScanRunning,!1)}),t.promise):(t.reject("transportation can not be initialised"),t.promise)},e.prototype.verifySalt=function(e){return e.salt[0]===this.currentSalt||!!e.salt[1]&&e.salt[1]===this.currentSalt},e.prototype.getCommandDetails=function(){return{salt:[this.currentSalt]}},e.prototype.getResponseDetails=function(){return{salt:[this.currentSalt]}},e.prototype.getStates=function(){var e=this.getAllPairedDevices(),n=this.getConnectedDevice();return this.states.set(o.HasConnectedDevices,!!n),this.states.set(o.HasPairedDevices,e&&e.length>0),this.states.set(o.PairedDeviceCount,e?e.length:0),this.states},e.prototype.setupInitialStates=function(){this.states=new Map,this.states.set(o.InitState,teamspace.services.ITransportComponentState.Uninitialized),this.states.set(o.IsScanRunning,!1),this.states.set(o.LastKeepAliveSentForSession,""),this.states.set(o.IsSendingKeepAlives,!1)},e.prototype.getAllPairedDevices=function(){return this.storageService.get(e.BTPairedDevicesKey)},e.prototype.rehydratePreviousConnection=function(){var n=this,t=this.getAllPairedDevices();if(t&&t.length>0){this.logger.info("Rehydrating transport connection");var o=this.storageService.get(e.LastSaltUpdateTimeKey);if((o=(new Date).getTime()-o)<6e4){var r=this.storageService.get(e.LastPairedDeviceEndpointKey);this.logger.info("salt was updated within 1 minute, time in milliseconds is "+o);var i=this.getCommandDetails(),s=this.transportCommandRouter.sendOutgoingCommand(teamspace.services.OutgoingCommand.Unlock,i,r);s||(this.logger.error("unlock command not created for quick unlock strategy, trying with long unlock strategy"),this.reconnectCallback=this.findProximalDeviceAndReconnect.bind(this),this.continousCheckProximity(!0)),s.promise.then(function(){n.logger.info("Unlock succeeded with quick unlock strategy"),n.reconnect(r)}).catch(function(e){n.logger.error("unlock command failed due to error - "+e+" in quick unlock strategy."),n.reconnectCallback=n.findProximalDeviceAndReconnect.bind(n),n.continousCheckProximity(!0)})}else this.logger.info("salt is not updated, trying to unlock by long unlock strategy"),this.reconnectCallback=this.findProximalDeviceAndReconnect.bind(this),this.continousCheckProximity(!0)}},e.prototype.onCompanionDevicesFound=function(e,n,t,r){var i=this;if(e){var s=e.data,a=this.transportDependencyProviderService,c=a.authenticationService,d=a.utilityService;c.getUserInformation().then(function(e){var a=d.packetGUID2String(s);e.profile.oid===a&&(i.logger.info("Better together companion device found and bleHandle is "+t+". Unsubscribing now"),i.bluetoothLEService.unsubscribe(t),i.updateSalt(s),clearTimeout(r),i.states.set(o.IsScanRunning,!1),n.resolve(!0))}).catch(function(e){i.logger.error("device with incorrect authentication sent payload"+e)})}},e.prototype.findProximalDeviceAndReconnect=function(e){var n=this;if(e){this.logger.info("Paired device in proximity. Will attempt keep alive to all paired devices");var t=this.getAllPairedDevices(),r=this.getCommandDetails();t&&0!==t.length&&t.forEach(function(e){n.logger.info("Sending keep alive to get status from "+e.endPointId);var t=n.transportCommandRouter.sendOutgoingCommand(teamspace.services.OutgoingCommand.KeepAlive,r,e.endPointId);t&&t.promise.then(function(t){n.logger.info("Keep alive successful from "+e.endPointId),n.reconnect(e.endPointId),n.states.set(o.LastKeepAliveSentForSession,new Date)})})}},e.prototype.reconnect=function(e){if(this.logger.info("Reconnecting to endpoint "+e),!this.getAllPairedDevices().find(function(n){return n.endPointId===e}))return!1;var n=this.getCommandDetails();return this.transportCommandRouter.sendOutgoingCommand(teamspace.services.OutgoingCommand.Unlock,n),this.setupKeepAlive(),this.transportCommandRouter.startSession(e),this.cleanUpContinousProximityScan(),!0},e.prototype.disconnect=function(n,t){void 0===n&&(n=!1),void 0===t&&(t=!1),this.logger.info("Disconnecting from paired device.");var r=this.getAllPairedDevices(),i=r?r.find(function(e){return e.connectionStatus===teamspace.services.PairedConnectionStatus.Connected}):void 0;if(i){if(clearInterval(this.keepAliveTimer),this.keepAliveTimer=void 0,this.states.set(o.IsSendingKeepAlives,!1),!n){var s=this.getCommandDetails();this.transportCommandRouter.sendOutgoingCommand(teamspace.services.OutgoingCommand.Lock,s)}i.connectionStatus=teamspace.services.PairedConnectionStatus.PairedNotConnected,this.storageService.set(e.LastPairedDeviceEndpointKey,i.endPointId),this.transportCommandRouter.endSession(i.endPointId),t&&this.keepScanOn()}},e.prototype.onProximityLost=function(){this.logger.error("Proximity lost. Stopping keep alive and starting continous scan for autopair"),this.disconnect(!1,!1),this.reconnectCallback=this.findProximalDeviceAndReconnect.bind(this),this.continousCheckProximity(!0)},e.prototype.setupKeepAlive=function(){var e=this;this.keepAliveTimer||(this.logger.info("Setting up keep alive"),this.states.set(o.IsSendingKeepAlives,!0),this.keepAliveTimer=setInterval(function(){e.sendKeepAlive().catch(function(n){e.logger.error("keep alive failed for 1st time - error "+n),e.onKeepAliveCheckFailed()})},this.keepAliveInterval))},e.prototype.onKeepAliveCheckFailed=function(){var e=this;clearInterval(this.keepAliveTimer),this.keepAliveTimer=void 0,this.sendKeepAlive().then(function(){e.setupKeepAlive()}).catch(function(){e.logger.error("Proximity lost, KeepAlive failed 2 times."),e.onProximityLost()})},e.prototype.sendKeepAlive=function(){var e=this,n=this.transportDependencyProviderService.$q.defer();return this.logger.info("checking proximity when trying to send keepAlive command"),this.checkProximity().then(function(t){if(t){var r=e.getCommandDetails(),i=e.transportCommandRouter.sendOutgoingCommand(teamspace.services.OutgoingCommand.KeepAlive,r);e.states.set(o.LastKeepAliveSentForSession,new Date),i.promise.then(function(){n.resolve("keepAlive successfull")})}else n.reject("checkProximity failed, device not in proximity")}).catch(function(e){n.reject("sending keepAlive failed with error - "+e)}),n.promise},e.prototype.updateSalt=function(n){if(n.length>18){var t=n[18]<<8|n[17];if(this.currentSalt!==t){this.currentSalt=t;var o=new Date;this.storageService.set(e.LastSaltUpdateTimeKey,o.getTime()),this.logger.info("Salt updated")}}},e.prototype.keepScanOn=function(){this.logger.log("Starting continous scan for keeping scan on for quick unlock strategy"),this.continousCheckProximity()},e.prototype.setupIpcForMachineState=function(){var e=this;this.ipcRenderer=window.electronSafeIpc,this.ipcRenderer&&this.transportDependencyProviderService.canInitializeTransport()&&(this.ipcEventHandler=function(n,t){t===e.constants.events.desktopApp.machineLock?(e.logger.info("Got machine locked/diconnect event"),e.cleanUpContinousProximityScan(),e.disconnect(!1,!0)):t===e.constants.events.desktopApp.machineUnlock&&(e.logger.info("Got machine unlocked/connect event"),e.cleanUpContinousProximityScan(),e.rehydratePreviousConnection())},this.ipcEventHandler=this.ipcEventHandler.bind(this),this.ipcRenderer.on(this.constants.events.desktopApp.machineInactiveResponse,this.ipcEventHandler))},e.prototype.cleanUpConnectionHandler=function(){this.logger.info("clean up of connectionHandler has been called. disconnecting the current device and removing all listeners to ipcRenderer"),this.disconnect(!1,!1),this.cleanUpContinousProximityScan(),this.ipcRenderer.removeListener(this.constants.events.desktopApp.machineInactiveResponse,this.ipcEventHandler),this.transportCommandRouter=void 0},e.prototype.cleanUpContinousProximityScan=function(){this.logger.info("cleaning up continousProximityScan related promise and bleHandle."),clearInterval(this.continousCheckProximityInterval),this.continousCheckProximityInterval=void 0},e.BTPairedDevicesKey="BTPairedDevices",e.LastSaltUpdateTimeKey="LastSaltUpdateTime",e.LastPairedDeviceEndpointKey="LastPairedDeviceEndpoint",e}();n.TransportConnectionHandler=r},2243:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o,r=t(2244),i=t(2253);!function(e){e.InitState="InitState",e.ActiveIncomingCommandsCount="ActiveIncomingCommandsCount",e.ActiveOutgoingCommandsCount="ActiveOutgoingCommandsCount",e.AckFailedCountInSession="AckFailedCountInSession",e.AckSuccessCountInSession="AckSuccessCountInSession"}(o||(o={}));var s=function(){function e(e,n,t){this.transportDependencyProviderService=e,this.transportStack=n,this.transportUser=t,this.ComponentName="TransportCommandRouter",this.ackSuccessCount=0,this.ackFailureCount=0,this.outgoingCommandResponseTimeout=6e4,this.incomingCommandFactory=new r.IncomingCommandFactory(e),this.outgoingCommandFactory=new i.OutgoingCommandFactory(e),this.activeIncomingCommands=new Map,this.activeOutgoingCommands=new Map,this.setupInitialStates(),this.settingsService=e.settingsService,this.constants=e.constants,this.logger=e.loggingService.newLogger(this.ComponentName),this.states.set(o.InitState,teamspace.services.ITransportComponentState.Initialized)}return e.prototype.onIncomingCommandReceived=function(e,n){var t=this,o=this.transportDependencyProviderService.loggingService.newScenario(this.constants.scenarios.betterTogether.commandRouter.incomingCommandReceived,null,null,null,!0),r=this.validateIncomingCommand(e,n);if(!r.result)return o.fail({error:r.message,error1:r.message}),void this.logger.error(r.message);var i=e.command;if(this.logger.info("Incoming command received with name - "+i),i!==teamspace.services.IncomingCommand.Response){var s=this.incomingCommandFactory.createCommand(e,o);if(!s){var a="Incoming Command not created for "+e.command+". Command not compatible or implemented";return o.fail({error:a,error1:a}),this.logger.error(a),void this.ackIncomingCommandFailure(n)}this.activeIncomingCommands.set(e.causeId,s),o.stop({message:"command created successfully with name - "+e.command,message1:"command created successfully with name - "+e.command}),this.ackIncomingCommandSuccess(n),s.action().promise.then(function(n){t.sendResponse(e,n),t.logger.info("Sending response for "+e.command)}).catch(function(n){t.sendResponse(e,n,!0),t.logger.error("Error in executing command "+e.command+" - Error - "+n.errorDetails)})}else{this.ackIncomingCommandSuccess(n);var c=JSON.parse(e.commandDetails),d=this.onResponseReceivedForOutgoingCommand(c);d.result?o.stop({message:"incoming command is a successful response for an outgoing command",message1:"incoming command is a successful response for an outgoing command"}):o.fail({error:d.message,error1:d.message})}},e.prototype.ackIncomingCommandSuccess=function(e){var n=e({status:200,body:JSON.stringify({})}),t=this.transportDependencyProviderService.loggingService.newScenario(this.constants.scenarios.betterTogether.commandRouter.ackIncomingCommand,null,null,null,!0);if(0!==n){var o="Failed to send ack for the incoming command - result: "+n;t.fail({error:o,error1:o}),this.logger.error(o)}else{var r="Ack sent for incoming command";t.stop({message:r,message1:r}),this.logger.info(r)}},e.prototype.ackIncomingCommandFailure=function(e,n){var t=e({status:404,body:n?JSON.stringify(n):JSON.stringify({})}),o=this.transportDependencyProviderService.loggingService.newScenario(this.constants.scenarios.betterTogether.commandRouter.ackIncomingCommand,null,null,null,!0);if(0!==t){var r="Failed to send failure for the incoming command - result: "+t;o.fail({error:r,error1:r}),this.logger.error(r)}else{var i="Failed-Ack-response sent for incoming command";o.stop({message:i,message1:i}),this.logger.info(i)}},e.prototype.validateIncomingCommand=function(e,n){var t={message:"",result:!1};if(!this.settingsService.valueAsBoolean(this.constants.settings.names.enableBetterTogetherConnections)){i="ECS not enabled. Received incoming command "+e.command;return this.logger.error(i),t.message=i,t.result=!1,t}if(!e){i="Invalid transport command";return this.logger.error(i),t.message=i,t.result=!1,t}var o=this.transportDependencyProviderService.callingAgentsService,r=JSON.parse(e.commandDetails);if(r.targetEndpointId&&o.getRegistrationId()!==r.targetEndpointId){var i="Incoming commmand is not meant for this endpoint id";return this.logger.error(i),t.message=i,t.result=!1,this.ackIncomingCommandFailure(n),t}return t.message="Incoming command request is valid.",t.result=!0,t},e.prototype.cleanupIncomingCommand=function(e){var n=this.activeIncomingCommands.get(e);n&&(this.activeIncomingCommands.delete(e),n=void 0)},e.prototype.sendResponse=function(e,n,t){var o=this;void 0===t&&(t=!1);var r=t?400:200,i=e.causeId;if(this.activeIncomingCommands.get(i)){if(n){n.statusCode=r,n.requestCauseId=i;var s=this.sendOutgoingCommand(teamspace.services.OutgoingCommand.Response,n,e.endpointId);s?s.promise.then(function(e){o.logger.info("Response completed")}):this.logger.error("Response command not created")}this.cleanupIncomingCommand(i)}},e.prototype.sendOutgoingCommand=function(e,n,t){var o=this,r=this.transportDependencyProviderService.loggingService.newScenario(this.constants.scenarios.betterTogether.commandRouter.sendOutgoingCommand,null,null,null,!0);if(!this.settingsService.valueAsBoolean(this.constants.settings.names.enableBetterTogetherConnections)){a="FF not enabled for outgoing command "+e;throw r.fail({error:a,error1:a}),this.logger.error(a),a}var i;if(t?i=this.getIBTTransportEndpoint(t,!0):(i=this.getIBTTransportEndpoint(t,!1))&&this.isSessionEstablishedWithEndpoint(i)||(i=this.getIBTTransportEndpoint(t,!0)),!i){a="Outgoing Command not created for "+e+". No available endpoint to send the command to";return r.fail({error:a,error1:a}),this.logger.error(a),null}n.targetEndpointId=i.getEndpointId();var s=this.outgoingCommandFactory.createCommand(e,n,i);if(!s){var a="Command not created for "+e+". Not compatible or implemented";return r.fail({error:a,error1:a}),this.logger.error(a),null}return this.activeOutgoingCommands.set(s.causeId,s),s.onCommandReadyToSend.promise.then(function(t){var i=o.createBTTOutgoingCommandListener(r);s.commandResponseListener=i;var a=n?JSON.stringify(n):"";if(o.isSessionEstablishedWithEndpoint(s.endpoint)){c="outgoing command sent for command name - "+e;o.logger.info(c),r.appendEventData({message:c}),s.endpoint.sendCommand(s.causeId,e,a,i)}else{var c="Sending command for session setup, command name - "+e;o.logger.info(c),r.appendEventData({reason:c,reason1:c}),s.endpoint.setupSession(s.causeId,e,a,i)}setTimeout(function(){var n;-1!==o.cleanupOutgoingCommand(s.causeId)&&(n="no response received for outgoing command with name - "+e+" within threshold time.",s.onResponseReceived.reject(n),o.logger.error(n),r.stop({message:n,message1:n}))},o.outgoingCommandResponseTimeout)}).catch(function(e){var n={errorDetails:e,statusCode:400,salt:[-1],requestCauseId:s.causeId};s.onResponseReceived.reject(n),o.cleanupOutgoingCommand(s.causeId),r.fail({message:"outgoing command rejected itself after failing - Error - "+e,message1:"outgoing command rejected itself after failing - Error - "+e})}),s.onResponseReceived},e.prototype.isSessionEstablishedWithEndpoint=function(e){var n=this.transportDependencyProviderService.getPairedAndActiveEndpoint();return!(!n||!e)&&n.endPointId===e.getEndpointId()},e.prototype.startSession=function(e){this.logger.info("starting session with endpoint with a force discover.");var n=this.getIBTTransportEndpoint(e,!0);n&&n.setSessionEstablished(!0)},e.prototype.endSession=function(e){this.logger.info("ending session with endpoint without a force discover.");var n=this.getIBTTransportEndpoint(e,!1);n&&(n.setSessionEstablished(!1),this.ackFailureCount=0,this.ackSuccessCount=0)},e.prototype.getStates=function(){return this.states.set(o.ActiveOutgoingCommandsCount,this.activeOutgoingCommands.size),this.states.set(o.ActiveIncomingCommandsCount,this.activeIncomingCommands.size),this.states.set(o.AckFailedCountInSession,this.ackFailureCount),this.states.set(o.AckSuccessCountInSession,this.ackSuccessCount),this.states},e.prototype.setupInitialStates=function(){this.states=new Map,this.states.set(o.InitState,teamspace.services.ITransportComponentState.Uninitialized)},e.prototype.onResponseReceivedForOutgoingCommand=function(e){var n={message:"",result:!1};if(!e.requestCauseId){o="Request cause id not found with the response";return n.result=!1,n.message=o,this.logger.error(o),n}var t=this.activeOutgoingCommands.get(e.requestCauseId);if(!t){o="No outgoing command found with the requestCauseId or response not required";return n.result=!1,n.message=o,this.logger.error(o),n}if(200!==e.statusCode){var o="response is not OK for command name - "+t.name+", status code- "+e.statusCode+" and error details - "+e.errorDetails;n.result=!1,n.message=o,this.logger.error(o),t.onResponseReceived.reject(e)}else{var r="response resolved for outgoing command name - "+t.name;n.result=!0,n.message=r,this.logger.info(r),t.onResponseReceived.resolve(e)}return this.cleanupOutgoingCommand(e.requestCauseId),n},e.prototype.cleanupOutgoingCommand=function(e){var n=this.activeOutgoingCommands.get(e);if(n){n.commandResponseListener&&n.commandResponseListener.dispose(),this.logger.info("Command with causeid - "+e+" cleaned up");var t=n.startTime;if(this.activeOutgoingCommands.delete(e),n=void 0,t)return(new Date).getTime()-t.getTime()}return-1},e.prototype.createBTTOutgoingCommandListener=function(e){var n=this,t=this.transportStack.createOutgoingCommandResponse();return t.on("request-succeeded",function(t){var o=t.causeId,r=t.responseBody;n.ackSuccessCount++,n.logger.info("Received transport response for "+o+".");var i=n.activeOutgoingCommands.get(o);if(i){var s=r?JSON.parse(r):void 0;if(i.commandDetails.companionResponseRequired){c="Command acknowledged by companion device,command name - "+i.name+", requires response from device";n.logger.info(c),e.stop({message:c,message1:c})}else{i.onResponseReceived.resolve(s);var a=n.cleanupOutgoingCommand(o),c="Outgoing command does not need response,command name - "+i.name+" time taken is "+a;n.logger.info(c),e.stop({message:c,message1:c})}}else n.logger.error("No valid outgoing command."),e.fail({error:"No valid outgoing command.",error1:"No valid outgoing command."})}),t.on("request-failed",function(t){var o=t.causeId,r=t.errorCode,i=t.responseBody;n.ackFailureCount++,n.logger.info("Received transport response. errorCode - "+r);var s=n.activeOutgoingCommands.get(o);if(s){if(!s.isRetry&&-1950875510===r){var a=s.startTime,c=0;a&&(c=(new Date).getTime()-a.getTime());var d="received error response for outgoing command name - "+s.name+", causeId "+o+", errorCode - "+r+", time taken is "+c;n.logger.error(d);var p=JSON.stringify(s.commandDetails);s.isRetry=!0;var m=s.endpoint.getEndpointId(),l=n.getIBTTransportEndpoint(m,!0);s.endpoint=l;var u=n.transportDependencyProviderService.utilityService.generateUUID();return s.causeId=u,n.activeOutgoingCommands.delete(o),n.activeOutgoingCommands.set(u,s),n.logger.error("First attempt for command failed. Retry-ing command "+s.name+", causeId "+o+" with new causeid "+u),void l.sendCommand(s.causeId,s.name,p,s.commandResponseListener)}var g=i?JSON.parse(i):{};g.statusCode=r,s.onResponseReceived.reject(g);var v=n.cleanupOutgoingCommand(o),h="Failed on second attempt. received error response for outgoing command name - "+s.name+", causeId "+o+", errorCode - "+r+", time taken is "+v;n.logger.error(h),e.fail({error:h,error1:h})}else{h="No valid outgoing command";n.logger.error(h),e.fail({error:h,error1:h})}}),t},e.prototype.getIBTTransportEndpoint=function(e,n){if(void 0===n&&(n=!1),!e){this.logger.info("endpoint id is not given, trying to get it from pairedAndActive Endpoint");var t=this.transportDependencyProviderService.getPairedAndActiveEndpoint();if(!t)return this.logger.error("There is no active paired device to send the command."),null;e=t.endPointId}this.logger.info("trying to get endpoint from transport user for endpointid - "+e);var o;return n?(o=this.transportUser.discover().find(function(n){return n.getEndpointId()===e}),this.logger.info("endponts retrieved using discover(). "+!!o)):(o=this.transportUser.getEndpoints().find(function(n){return n.getEndpointId()===e}),this.logger.info("endponts retrieved using getEndpoints(). "+!!o)),o},e}();n.TransportCommandRouter=s},2244:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=t(2245),r=t(2246),i=t(2247),s=t(2248),a=t(2249),c=t(2250),d=t(2251),p=t(2252),m=function(){function e(e){this.transportDependencyProviderService=e,this.logger=e.loggingService.newLogger("IncomingCommandFactory")}return e.prototype.createCommand=function(e,n){var t=e.command.toLowerCase(),m=JSON.parse(e.commandDetails),l=e.endpointId,u=this.shouldCreateCommand(t,m,e);if(!u.result)return n.appendEventData({reason:u.message,reason1:u.message}),null;switch(t){case teamspace.services.IncomingCommand.Broadcast:return new o.BroadcastCommand(m,this.transportDependencyProviderService);case teamspace.services.IncomingCommand.Pair:return new r.PairCommand(m,l,this.transportDependencyProviderService);case teamspace.services.IncomingCommand.Unpair:return new i.UnpairCommand(m,l,this.transportDependencyProviderService);case teamspace.services.IncomingCommand.Autopair:return new s.AutopairCommand(m,l,this.transportDependencyProviderService);case teamspace.services.IncomingCommand.Locked:return new a.LockedCommand(m,l,this.transportDependencyProviderService);case teamspace.services.IncomingCommand.Unlocked:return new c.UnlockedCommand(m,l,this.transportDependencyProviderService);case teamspace.services.IncomingCommand.ReplyOnDesktop:return new d.ReplyFromDesktopCommand(m,this.transportDependencyProviderService);case teamspace.services.IncomingCommand.OpenFileOnDesktop:return new p.OpenFileCommand(m,this.transportDependencyProviderService);default:return null}},e.prototype.shouldCreateCommand=function(e,n,t){var o={message:"",result:!1};if(!this.transportDependencyProviderService.canInitializeTransport()){a="Transport layer cannot be initialized. Failing command creation";return this.logger.error(a),o.message=a,o.result=!1,o}var r=this.transportDependencyProviderService.getTransportConnectionHandler();if(!(e===teamspace.services.IncomingCommand.Broadcast||e===teamspace.services.IncomingCommand.Unpair||r.verifySalt(n))){a="Salt is not valid";return this.logger.error(a),o.message=a,o.result=!1,o}var i=r.getConnectedDevice(),s=e===teamspace.services.IncomingCommand.Broadcast||e===teamspace.services.IncomingCommand.Unpair||e===teamspace.services.IncomingCommand.Pair||e===teamspace.services.IncomingCommand.Autopair;if(e===teamspace.services.IncomingCommand.Pair||e===teamspace.services.IncomingCommand.Autopair){if(i&&i.endPointId!==t.endpointId){a="Cannot execute pairing related command with name - "+e+" while in active paired state with a different endpoint";return this.logger.error(a),o.message=a,o.result=!1,o}return o.result=!0,o}if(!s&&!i){var a="Cannot execute command name - "+e+", there are no active endpoints.";return this.logger.error(a),o.message=a,o.result=!1,o}return o.result=!0,o},e}();n.IncomingCommandFactory=m},2245:function(e,n,t){"use strict";var o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var n,t=1,o=arguments.length;t<o;t++){n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)};Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,n){this.commandDetails=e,this.transportDependencyProviderService=n,this.commandDetails=e}return e.prototype.action=function(){var e=this,n=this.transportDependencyProviderService,t=n.$q,r=n.resources,i=n.$translate;this.responseDeferred=t.defer();var s=this.transportDependencyProviderService.getTransportConnectionHandler(),a=this.transportDependencyProviderService.loggingService.newScenario(this.transportDependencyProviderService.constants.scenarios.betterTogether.incomingCommand.broadcast,null,null,null,!0);return this.transportDependencyProviderService.getTransportConnectionHandler().checkProximity().then(function(n){if(n){var t=window.desktopEnvironment.hostname?window.desktopEnvironment.hostname:i.instant(r.strings.meeting_unknown_status_text),c=o({deviceName:t},s.getResponseDetails());a.stop({message:"device in proximity,resolving response",message1:"device in proximity,resolving response"}),e.responseDeferred.resolve(c)}else{c=o({errorDetails:"Companion device is not in proximity."},s.getResponseDetails());a.stop({error:c.errorDetails,error1:c.errorDetails}),e.responseDeferred.reject(c)}}).catch(function(n){var t=o({errorDetails:n},s.getResponseDetails());a.fail({error:t.errorDetails,error1:t.errorDetails}),e.responseDeferred.reject(t)}),this.responseDeferred},e}();n.BroadcastCommand=r},2246:function(e,n,t){"use strict";var o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var n,t=1,o=arguments.length;t<o;t++){n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)};Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,n,t){this.commandDetails=e,this.endpointId=n,this.transportDependencyProviderService=t}return e.prototype.action=function(){var e=this,n=this.transportDependencyProviderService,t=n.$q,o=n.$translate,r=n.resources,i=n.dialogService;this.responseDeferred=t.defer();var s=!1,a={okButtonText:o.instant(r.strings.better_together_pair_button),closeButtonText:o.instant(r.strings.better_together_cancel_button),confirmMessageTitle:o.instant(r.strings.better_together_pair_title),confirmMessageHtmlBody:o.instant(r.strings.better_together_pair_message,{deviceName:this.commandDetails.deviceName}),callback:function(){s=!0,e.onUserResponse(!0)},preCloseCallback:function(){s||e.onUserResponse(!1)}};return i.open(this.transportDependencyProviderService.constants.dialogs.confirmDialog,a),this.responseDeferred},e.prototype.onUserResponse=function(e,n){var t=this.transportDependencyProviderService.getTransportConnectionHandler(),r=o({accepted:e},t.getResponseDetails()),i=this.transportDependencyProviderService.loggingService.newScenario(this.transportDependencyProviderService.constants.scenarios.betterTogether.incomingCommand.pair,null,null,null,!0);if(e){var s={endPointId:this.endpointId,deviceName:this.endpointId,connectionStatus:teamspace.services.PairedConnectionStatus.Connected};i.stop({message:"pairing accepted by user",message1:"pairing accepted by user"}),t.onNewDevicePaired(s),this.responseDeferred.resolve(r)}else r.accepted=!1,r.errorDetails="Pair rejected by the user",i.fail({error:r.errorDetails,error1:r.errorDetails}),this.responseDeferred.reject(r)},e}();n.PairCommand=r},2247:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,n,t){this.commandDetails=e,this.endPointId=n,this.transportDependencyProviderService=t}return e.prototype.action=function(){var e=this.transportDependencyProviderService.$q;this.responseDeferred=e.defer();var n={endPointId:this.endPointId,deviceName:this.endPointId,connectionStatus:teamspace.services.PairedConnectionStatus.Connected},t=this.transportDependencyProviderService.loggingService.newScenario(this.transportDependencyProviderService.constants.scenarios.betterTogether.incomingCommand.unpair,null,null,null,!0),o=this.transportDependencyProviderService.getTransportConnectionHandler().getResponseDetails();return this.transportDependencyProviderService.getTransportConnectionHandler().onDeviceUnpaired(n),t.stop({message:"Companion device Unpaired",message1:"Companion device Unpaired"}),this.responseDeferred.resolve(o),this.responseDeferred},e}();n.UnpairCommand=o},2248:function(e,n,t){"use strict";var o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var n,t=1,o=arguments.length;t<o;t++){n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)};Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,n,t){this.commandDetails=e,this.endpointId=n,this.transportDependencyProviderService=t,this.commandDetails=e}return e.prototype.action=function(){var e=this,n=this.transportDependencyProviderService.$q;this.responseDeferred=n.defer();var t=this.transportDependencyProviderService.getTransportConnectionHandler(),r=this.transportDependencyProviderService.loggingService.newScenario(this.transportDependencyProviderService.constants.scenarios.betterTogether.incomingCommand.autoPair,null,null,null,!0);return t.checkProximity().then(function(n){if(n)if(t.reconnect(e.endpointId))r.stop({message:"reconnected to Companion device.",message1:"reconnected to Companion device."}),e.responseDeferred.resolve(t.getResponseDetails());else{i=o({errorDetails:"Autopairing not successful from desktop client"},t.getResponseDetails());r.fail({error:i.errorDetails,error1:i.errorDetails}),e.responseDeferred.reject(i)}else{var i=o({errorDetails:"Companion device not in proximity"},t.getResponseDetails());r.fail({error:i.errorDetails,error1:i.errorDetails}),e.responseDeferred.reject(i)}}).catch(function(n){var i=o({errorDetails:n},t.getResponseDetails());r.fail({error:i.errorDetails,error1:i.errorDetails}),e.responseDeferred.reject(i)}),this.responseDeferred},e}();n.AutopairCommand=r},2249:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,n,t){this.commandDetails=e,this.endPointId=n,this.transportDependencyProviderService=t}return e.prototype.action=function(){var e=this.transportDependencyProviderService.$q;this.responseDeferred=e.defer();var n={endPointId:this.endPointId},t=this.transportDependencyProviderService.loggingService.newScenario(this.transportDependencyProviderService.constants.scenarios.betterTogether.incomingCommand.incomingLock,null,null,null,!0),o=this.transportDependencyProviderService.getTransportConnectionHandler(),r=o.getResponseDetails();return o.onDeviceLocked(n),t.stop({message:"Companion device locked",message1:"Companion device locked"}),this.responseDeferred.resolve(r),this.responseDeferred},e}();n.LockedCommand=o},2250:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,n,t){this.commandDetails=e,this.endPointId=n,this.transportDependencyProviderService=t}return e.prototype.action=function(){var e=this.transportDependencyProviderService.$q;this.responseDeferred=e.defer();var n={endPointId:this.endPointId},t=this.transportDependencyProviderService.loggingService.newScenario(this.transportDependencyProviderService.constants.scenarios.betterTogether.incomingCommand.incomingUnlock,null,null,null,!0),o=this.transportDependencyProviderService.getTransportConnectionHandler(),r=o.getResponseDetails();return o.onDeviceUnlocked(n),t.stop({message:"Companion device Unlocked",message1:"Companion device Unlocked"}),this.responseDeferred.resolve(r),this.responseDeferred},e}();n.UnlockedCommand=o},2251:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,n){this.commandDetails=e,this.transportDependencyProviderService=n}return e.prototype.action=function(){var e=this,n=this.transportDependencyProviderService,t=n.$q,o=n.callingNavigationService,r=n.channelService,i=n.multiWindowService;this.responseDeferred=t.defer();var s=this.transportDependencyProviderService.getTransportConnectionHandler().getResponseDetails(),a=this.transportDependencyProviderService.loggingService.newScenario(this.transportDependencyProviderService.constants.scenarios.betterTogether.incomingCommand.replyFromDesktop,null,null,null,!0);if(this.commandDetails.conversationId){var c=r.getChannelByObjectId(this.commandDetails.conversationId);i.enabled&&!c?i.openWindow(new teamspace.services.ChatChildWindowParams(this.commandDetails.conversationId),"ReplyFromDesktopCommand").then(function(n){a.stop({message:"opened in multi-window,resolving response",message1:"opened in multi-window,resolving response"}),e.responseDeferred.resolve(s)}).catch(function(n){s.errorDetails=n,a.fail({error:"error in opening new window with details - "+n,error1:"error in opening new window with details - "+n}),e.responseDeferred.reject(s)}):o.navigateToConversation(this.commandDetails.conversationId,this.commandDetails.rootMessageId).then(function(n){a.stop({message:"navigated to conversation,resolving response",message1:"navigated to conversation,resolving response"}),e.responseDeferred.resolve(s)}).catch(function(n){s.errorDetails=n,a.fail({error:"error in navigating to conversation with details - "+n,error1:"error in navigating to conversation with details - "+n}),e.responseDeferred.reject(s)})}else s.errorDetails="conversationId is empty",a.fail({error:s.errorDetails,error1:s.errorDetails}),this.responseDeferred.reject(s);return this.responseDeferred},e}();n.ReplyFromDesktopCommand=o},2252:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,n){this.commandDetails=e,this.transportDependencyProviderService=n}return e.prototype.action=function(){var e=this,n=this.transportDependencyProviderService,t=n.$q,o=n.deepLinkService;this.responseDeferred=t.defer();var r=this.transportDependencyProviderService.getTransportConnectionHandler().getResponseDetails(),i=this.transportDependencyProviderService.loggingService.newScenario(this.transportDependencyProviderService.constants.scenarios.betterTogether.incomingCommand.openFile,null,null,null,!0);return this.commandDetails.objectUrl&&this.commandDetails.fileId?o.resolveFileDeepLink(this.commandDetails).then(function(){i.stop({message:"file opened, resolving response",message1:"file opened, resolving response"}),e.responseDeferred.resolve(r)}).catch(function(n){r.errorDetails="deepLinkService rejected the promise",i.fail({error:r.errorDetails,error1:r.errorDetails}),e.responseDeferred.reject(r)}):(r.errorDetails="ObjectUrl is empty - "+!this.commandDetails.objectUrl+" or fileId is empty - "+!this.commandDetails.fileId,i.fail({error:r.errorDetails,error1:r.errorDetails}),this.responseDeferred.reject(r)),this.responseDeferred},e}();n.OpenFileCommand=o},2253:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=t(2254),r=t(2255),i=t(2256),s=t(2257),a=function(){function e(e){this.transportDependencyProviderService=e}return e.prototype.generateCauseId=function(){return this.transportDependencyProviderService.utilityService.generateUUID()},e.prototype.createCommand=function(e,n,t){var a;if(!this.transportDependencyProviderService.canInitializeTransport()||!t)return null;e=e.toLowerCase();var c=this.generateCauseId();switch(e){case teamspace.services.OutgoingCommand.Response:a=new o.ResponseCommand(c,t,n,this.transportDependencyProviderService);break;case teamspace.services.OutgoingCommand.KeepAlive:a=new r.KeepAliveCommand(c,t,n,this.transportDependencyProviderService);break;case teamspace.services.OutgoingCommand.Lock:a=new i.LockCommand(c,t,n,this.transportDependencyProviderService);break;case teamspace.services.OutgoingCommand.Unlock:a=new s.UnlockCommand(c,t,n,this.transportDependencyProviderService);break;default:return null}return a.name=e,a.startTime=new Date,a.isRetry=!1,a},e}();n.OutgoingCommandFactory=a},2254:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=function(){return function(e,n,t,o){this.causeId=e,this.endpoint=n,this.commandDetails=t,t.companionResponseRequired=!1;var r=o.$q;this.onResponseReceived=r.defer(),this.onCommandReadyToSend=r.defer(),this.onCommandReadyToSend.resolve(!0),this.onResponseReceived.resolve(null)}}();n.ResponseCommand=o},2255:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,n,t,o){this.causeId=e,this.endpoint=n,this.commandDetails=t,this.transportDependencyProviderService=o,t.companionResponseRequired=!0;var r=o.$q,i=this.onCommandExecuted.bind(this);this.onResponseReceived=r.defer(),this.onResponseReceived.promise.then(i).catch(i),this.onCommandReadyToSend=r.defer(),this.onCommandReadyToSend.resolve(!0)}return e.prototype.onCommandExecuted=function(e){var n=this.transportDependencyProviderService.loggingService.newScenario(this.transportDependencyProviderService.constants.scenarios.betterTogether.outgoingCommand.keepAlive,null,null,null,!0);if(e&&e.errorDetails){var t="Keepalive command failed for endpoint : "+this.endpoint.getEndpointId();return n.fail({error:t,error1:t}),this.transportDependencyProviderService.loggingService.error(t),void this.onResponseReceived.reject(e)}n.stop({message:"Keepalive command successfully resolved",message1:"Keepalive command successfully resolved"});var o=this.commandDetails;this.onResponseReceived.resolve(o)},e}();n.KeepAliveCommand=o},2256:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,n,t,o){this.causeId=e,this.endpoint=n,this.commandDetails=t,this.transportDependencyProviderService=o,t.companionResponseRequired=!1,this.onResponseReceived=o.$q.defer(),this.onCommandReadyToSend=o.$q.defer(),this.onCommandReadyToSend.resolve(!0);var r=this.onCommandExecuted.bind(this);this.onResponseReceived.promise.then(r).catch(r),this.logger=o.loggingService.newLogger("outgoingLockCommand")}return e.prototype.onCommandExecuted=function(e){var n=this.transportDependencyProviderService.loggingService.newScenario(this.transportDependencyProviderService.constants.scenarios.betterTogether.outgoingCommand.outgoingLock,null,null,null,!0);if(e&&!e.errorDetails){var t=this.transportDependencyProviderService.getTransportConnectionHandler().getConnectedDevice();if(!t)return this.logger.error("No device found"),void n.fail({error:"No device found",error1:"No device found"});this.transportDependencyProviderService.getTransportConnectionHandler().onDeviceLocked(t),this.logger.info("Companion device locked"),n.stop({message:"Companion device locked",message1:"Companion device locked"})}else{var o="";o=e?"Lock command failed, Error response: "+e.errorDetails:"NULL response received",this.logger.error(o),n.fail({error:o,error1:o})}},e}();n.LockCommand=o},2257:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,n,t,o){this.causeId=e,this.endpoint=n,this.commandDetails=t,this.transportDependencyProviderService=o,t.companionResponseRequired=!0,this.onResponseReceived=o.$q.defer(),this.onCommandReadyToSend=o.$q.defer(),this.onCommandReadyToSend.resolve(!0);var r=this.onCommandExecuted.bind(this);this.onResponseReceived.promise.then(r).catch(r),this.logger=o.loggingService.newLogger("outgoingUnlockCommand")}return e.prototype.onCommandExecuted=function(e){var n=this.transportDependencyProviderService.loggingService.newScenario(this.transportDependencyProviderService.constants.scenarios.betterTogether.outgoingCommand.outgoingUnlock,null,null,null,!0);if(e&&!e.errorDetails){var t=this.transportDependencyProviderService.getTransportConnectionHandler().getConnectedDevice();if(!t)return this.logger.error("No device found"),void n.fail({error:"No device found",error1:"No device found"});this.transportDependencyProviderService.getTransportConnectionHandler().onDeviceUnlocked(t),this.logger.info("Companion device unlocked"),n.stop({message:"Companion device unlocked",message1:"Companion device unlocked"})}else{var o="";o=e?"Unlock command failed, Error response: "+e.errorDetails:"NULL response received",this.logger.error(o),n.fail({error:o,error1:o})}},e}();n.UnlockCommand=o}},[2240]);
//# sourceMappingURL=https://statics.teams.cdn.office.net/hashedjs/lazy-ng1-mod-transport-agent-services.min.js-90749b48.map