set -g default-terminal 'tmux-256color'
set -g mouse on
set -s escape-time 10
set -g history-limit 50000
set -g display-time 4000
set -g focus-events on
set -g lock-command vlock

# Start windows and panes at 1, not 0
set -g base-index 1
setw -g pane-base-index 1

# Windows focus style
set -g window-style 'bg=colour18,fg=color8'
set -g window-active-style 'bg=black,fg=white'

# status bar
set-option -g status 2
set -g status-interval 1
set -g window-status-separator ' '
set -g window-status-current-style 'bg=black fg=green'
set -g  status-format[0] "#[align=left range=left #{E:status-left-style}]#[push-default]#{ session #{session_name}▕ }"
set -ag status-format[0] "#[pop-default]#[norange default]#[list=on align=#{status-justify}]#[list=left-marker]<#[list=right-marker]>#[list=on]#{W:#[range=window|#{window_index}#{E:window-status-style} #{?#{&&:#{window_last_flag},#{!=:#{E:window-status-last-style},default}}, #{E:window-status-last-style},}#{?#{&&:#{window_bell_flag},#{!=:#{E:window-status-bell-style},default}},#{E:window-status-bell-style},#{?#{&&:#{||:#{window_activity_flag},#{window_silence_flag}},#{!=:#{E:window-status-activity-style},default}}, #{E:window-status-activity-style},}}]#[push-default]#{T:window-status-format}#[pop-default]#[norange default]#{?window_end_flag,,#{window-status-separator}},#[range=window|#{window_index} list=focus #{?#{!=:#{E:window-status-current-style},default},#{E:window-status-current-style},#{E:window-status-style}}#{?#{&&:#{window_last_flag},#{!=:#{E:window-status-last-style},default}}, #{E:window-status-last-style},}#{?#{&&:#{window_bell_flag},#{!=:#{E:window-status-bell-style},default}}, #{E:window-status-bell-style},#{?#{&&:#{||:#{window_activity_flag},#{window_silence_flag}},#{!=:#{E:window-status-activity-style},default}}, #{E:window-status-activity-style},}}]#[push-default]#{T:window-status-current-format}#[pop-default]#[norange list=on default]#{?window_end_flag,,#{window-status-separator}}}#[nolist align=right range=right]#[push-default]"
set -ag status-format[0] "▕ #{?window_bigger,[#{window_offset_x}#,#{window_offset_y}] ,}#{user}@#{=21:host} (#(ip route get 1.2.3.4 | cut -d ' ' -f 7))▕ %Y-%m-%d %H:%M:%S #[pop-default]#[norange default]"
set -g  status-format[1] "#[fill=color18 bg=color18 fg=white align=right]▕ #(/home/lapointepinelb/.dotfiles/.config/tmux/status-script/cpu_usage.sh)#[fg=white]▕ #(/home/lapointepinelb/.dotfiles/.config/tmux/status-script/memory.sh)#[fg=white]▕ #(/home/lapointepinelb/.dotfiles/.config/tmux/status-script/disk.sh) "

set -g prefix C-a
bind C-a send-prefix

bind | split-window -h -c "#{pane_current_path}"
bind _ split-window -v -c "#{pane_current_path}"
bind Enter new-window
bind Left select-pane -L
bind Right select-pane -R
bind Up select-pane -U
bind Down select-pane -D
bind h select-pane -L
bind l select-pane -R
bind j select-pane -U
bind k select-pane -D
bind \{ swap-pane -U
bind \} swap-pane -D
bind L lock-session

bind C-r source-file ~/.config/tmux/tmux.conf
bind C-\\ display-popup -E -w 90% -h 90% 'tmux new-session -A -s scratch'
bind C-t display-popup -E -w 90% -h 90% 'taskwarrior-tui'

# https://unix.stackexchange.com/a/285648
bind-key 0 if-shell 'tmux select-window -t :0' '' 'new-window -t :0'
bind-key 1 if-shell 'tmux select-window -t :1' '' 'new-window -t :1'
bind-key 2 if-shell 'tmux select-window -t :2' '' 'new-window -t :2'
bind-key 3 if-shell 'tmux select-window -t :3' '' 'new-window -t :3'
bind-key 4 if-shell 'tmux select-window -t :4' '' 'new-window -t :4'
bind-key 5 if-shell 'tmux select-window -t :5' '' 'new-window -t :5'
bind-key 6 if-shell 'tmux select-window -t :6' '' 'new-window -t :6'
bind-key 7 if-shell 'tmux select-window -t :7' '' 'new-window -t :7'
bind-key 8 if-shell 'tmux select-window -t :8' '' 'new-window -t :8'
bind-key 9 if-shell 'tmux select-window -t :9' '' 'new-window -t :9'

bind-key M-0 if-shell 'tmux break-pane -d -t 0' '' 'join-pane -d -t 0'
bind-key M-1 if-shell 'tmux break-pane -d -t 1' '' 'join-pane -d -t 1'
bind-key M-2 if-shell 'tmux break-pane -d -t 2' '' 'join-pane -d -t 2'
bind-key M-3 if-shell 'tmux break-pane -d -t 3' '' 'join-pane -d -t 3'
bind-key M-4 if-shell 'tmux break-pane -d -t 4' '' 'join-pane -d -t 4'
bind-key M-5 if-shell 'tmux break-pane -d -t 5' '' 'join-pane -d -t 5'
bind-key M-6 if-shell 'tmux break-pane -d -t 6' '' 'join-pane -d -t 6'
bind-key M-7 if-shell 'tmux break-pane -d -t 7' '' 'join-pane -d -t 7'
bind-key M-8 if-shell 'tmux break-pane -d -t 8' '' 'join-pane -d -t 8'
bind-key M-9 if-shell 'tmux break-pane -d -t 9' '' 'join-pane -d -t 9'

unbind '"'
unbind %

# set -g @plugin 'tmux-plugins/tmux-resurrect'
run '~/.config/tmux/plugins/tpm/tpm'
